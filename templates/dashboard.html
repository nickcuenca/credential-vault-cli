<!DOCTYPE html>
<html>
<head>
    <title>Vault Dashboard</title>
    <script>
        function searchSites() {
            const query = document.getElementById("search").value.toLowerCase();
            const entries = document.getElementsByClassName("credential-entry");

            for (let entry of entries) {
                const siteName = entry.getAttribute("data-site").toLowerCase();
                entry.style.display = siteName.includes(query) ? "block" : "none";
            }
        }

        function copyToClipboard(password) {
            navigator.clipboard.writeText(password).then(() => {
                alert("ğŸ”‘ Password copied to clipboard!");
            });
        }
    </script>
</head>
<body>
    <h1>ğŸ” Your Vault</h1>

    <input type="text" id="search" placeholder="Search site..." onkeyup="searchSites()">
    <br><br>

    <a href="{{ url_for('add') }}">â• Add Credential</a>
    <a href="{{ url_for('export') }}">ğŸ“¦ Export</a>
    <a href="{{ url_for('audit') }}">ğŸ“– Audit Log</a>
    <a href="{{ url_for('logout') }}">ğŸšª Logout</a>

    {% if credentials %}
        <ul>
        {% for site, creds in credentials.items() %}
            <li class="credential-entry" data-site="{{ site }}">
                <strong>{{ site }}</strong><br>
                ğŸ‘¤ {{ creds['username'] }}<br>
                ğŸ”‘ <span id="pw-{{ loop.index }}">{{ creds['password'] }}</span>
                <button onclick="copyToClipboard('{{ creds['password'] | escape }}')">ğŸ“‹ Copy</button>
                <form action="{{ url_for('delete', site=site) }}" method="POST" style="display:inline;">
                    <button type="submit">ğŸ—‘ï¸ Delete</button>
                </form>
                <a href="{{ url_for('edit', site=site) }}">âœï¸ Edit</a>
            </li>
        {% endfor %}
        </ul>
    {% else %}
        <p>No credentials saved yet.</p>
    {% endif %}
</body>
</html>